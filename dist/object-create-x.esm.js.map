{"version":3,"sources":["../src/object-create-x.js"],"names":[],"mappings":"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","file":"object-create-x.esm.js","sourcesContent":["import attempt from 'attempt-x';\nimport isPrimitive from 'is-primitive';\nimport defineProperties from 'object-define-properties-x';\n\n/** @type {BooleanConstructor} */\nconst castBoolean = true.constructor;\nconst nativeCreate = typeof Object.create === 'function' && Object.create;\n\nlet isWorking;\n\nif (nativeCreate) {\n  let res = attempt(nativeCreate, null);\n  isWorking = res.threw === false && res.value && typeof res.value === 'object';\n\n  if (isWorking) {\n    /* eslint-disable-next-line guard-for-in,no-restricted-syntax,no-unused-vars */ // noinspection LoopStatementThatDoesntLoopJS\n    for (const _ in res.value) {\n      isWorking = false;\n      break;\n    }\n  }\n\n  if (isWorking) {\n    res = attempt(nativeCreate, null, {test: {value: true}});\n    isWorking = res.threw === false && res.value && typeof res.value === 'object' && res.value.test === true;\n  }\n\n  if (isWorking) {\n    // Shape - superclass\n    const Shape = function Shape() {\n      // noinspection JSUnusedGlobalSymbols\n      this.x = 0;\n      // noinspection JSUnusedGlobalSymbols\n      this.y = 0;\n    };\n\n    // superclass method\n    Shape.prototype.move = function move(x, y) {\n      // noinspection JSUnusedGlobalSymbols\n      this.x += x;\n      // noinspection JSUnusedGlobalSymbols\n      this.y += y;\n\n      return 'Shape moved.';\n    };\n\n    // Rectangle - subclass\n    const Rectangle = function Rectangle() {\n      Shape.call(this); // call super constructor.\n    };\n\n    res = attempt(nativeCreate, Shape.prototype);\n    isWorking = res.threw === false && res.value && typeof res.value === 'object';\n\n    if (isWorking) {\n      // subclass extends superclass\n      Rectangle.prototype = res.value;\n      Rectangle.prototype.constructor = Rectangle;\n\n      const rect = new Rectangle();\n\n      isWorking = rect instanceof Rectangle;\n\n      if (isWorking) {\n        isWorking = rect instanceof Shape;\n      }\n\n      if (isWorking) {\n        isWorking = rect.move(1, 1) === 'Shape moved.';\n      }\n    }\n  }\n}\n\n/**\n * This method method creates a new object with the specified prototype object and properties.\n *\n * @param {*} prototype - The object which should be the prototype of the newly-created object.\n * @param {*} [properties] - If specified and not undefined, an object whose enumerable own properties\n * (that is, those properties defined upon itself and not enumerable properties along its prototype chain)\n * specify property descriptors to be added to the newly-created object, with the corresponding property names.\n * @throws {TypeError} If the properties parameter isn't null or an object.\n * @returns {boolean} A new object with the specified prototype object and properties.\n */\nlet $create;\n\nif (isWorking) {\n  $create = nativeCreate;\n} else {\n  const doc = typeof document !== 'undefined' && document;\n\n  // Contributed by Brandon Benvie, October, 2012\n  let createEmpty;\n  const supportsProto = {__proto__: null} instanceof Object === false;\n  // the following produces false positives\n  // in Opera Mini => not a reliable check\n  // Object.prototype.__proto__ === null\n\n  if (supportsProto || castBoolean(doc) === false) {\n    createEmpty = function $createEmpty() {\n      return {__proto__: null};\n    };\n  } else {\n    // Check for document.domain and active x support\n    // No need to use active x approach when document.domain is not set\n    // see https://github.com/es-shims/es5-shim/issues/150\n    // variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n    const shouldUseActiveX = function _shouldUseActiveX() {\n      // return early if document.domain not set\n      if (castBoolean(doc.domain) === false) {\n        return false;\n      }\n\n      const result = attempt(() => {\n        /* eslint-disable-next-line no-undef */\n        return new ActiveXObject('htmlfile');\n      });\n\n      return result.threw === false && Boolean(result.value);\n    };\n\n    // This supports IE8 when document.domain is used\n    // see https://github.com/es-shims/es5-shim/issues/150\n    // variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n    const getEmptyViaActiveX = function _getEmptyViaActiveX() {\n      /* eslint-disable-next-line no-undef */\n      let xDoc = new ActiveXObject('htmlfile');\n      /* eslint-disable-next-line no-useless-escape,prettier/prettier */\n      xDoc.write('<script><\\/script>');\n      xDoc.close();\n\n      // noinspection JSUnresolvedVariable\n      const empty = xDoc.parentWindow.Object.prototype;\n      xDoc = null;\n\n      return empty;\n    };\n\n    // The original implementation using an iframe\n    // before the activex approach was added\n    // see https://github.com/es-shims/es5-shim/issues/150\n    const getEmptyViaIFrame = function _getEmptyViaIFrame() {\n      let iframe = doc.createElement('iframe');\n      iframe.style.display = 'none';\n      /* eslint-disable-next-line no-script-url */\n      iframe.src = 'javascript:';\n\n      const parent = doc.body || doc.documentElement;\n      parent.appendChild(iframe);\n\n      const empty = iframe.contentWindow.Object.prototype;\n      parent.removeChild(iframe);\n      iframe = null;\n\n      return empty;\n    };\n\n    // In old IE __proto__ can't be used to manually set `null`, nor does\n    // any other method exist to make an object that inherits from nothing,\n    // aside from Object.prototype itself. Instead, create a new global\n    // object and *steal* its Object.prototype and strip it bare. This is\n    // used as the prototype to create nullary objects.\n    createEmpty = function $createEmpty() {\n      // Determine which approach to use\n      // see https://github.com/es-shims/es5-shim/issues/150\n      const empty = shouldUseActiveX() ? getEmptyViaActiveX() : getEmptyViaIFrame();\n\n      delete empty.constructor;\n      delete empty.hasOwnProperty;\n      delete empty.propertyIsEnumerable;\n      delete empty.isPrototypeOf;\n      delete empty.toLocaleString;\n      delete empty.toString;\n      delete empty.valueOf;\n\n      /* eslint-disable-next-line lodash/prefer-noop */\n      const E = function Empty() {};\n\n      E.prototype = empty;\n      // short-circuit future calls\n      createEmpty = function $$createEmpty() {\n        return new E();\n      };\n\n      return new E();\n    };\n  }\n\n  $create = function create(prototype, properties) {\n    let object;\n    /* eslint-disable-next-line lodash/prefer-noop */\n    const T = function Type() {}; // An empty constructor.\n\n    if (prototype === null) {\n      object = createEmpty();\n    } else {\n      if (isPrimitive(prototype)) {\n        // In the native implementation `parent` can be `null`\n        // OR *any* `instanceof Object`  (Object|Function|Array|RegExp|etc)\n        // Use `typeof` tho, b/c in old IE, DOM elements are not `instanceof Object`\n        // like they are in modern browsers. Using `Object.create` on DOM elements\n        // is...err...probably inappropriate, but the native version allows for it.\n        throw new TypeError('Object prototype may only be an Object or null'); // same msg as Chrome\n      }\n\n      T.prototype = prototype;\n      object = new T();\n      // IE has no built-in implementation of `Object.getPrototypeOf`\n      // neither `__proto__`, but this manually setting `__proto__` will\n      // guarantee that `Object.getPrototypeOf` will work as expected with\n      // objects created using `Object.create`\n      /* eslint-disable-next-line no-proto */\n      object.__proto__ = prototype;\n    }\n\n    if (typeof properties !== 'undefined') {\n      defineProperties(object, properties);\n    }\n\n    return object;\n  };\n}\n\nconst create = $create;\n\nexport default create;\n"]}